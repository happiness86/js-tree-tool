const tree = require('../dist/index')
const treeData = require('./data.json')

const instance = tree.createInstance({
  children: 'child'
})

const selectedData = '110102,110105,110106,110107,110108,110109,110111,110112,110113,110114,110115,110116,110117,110118,110119,120000,120101,120102,120103,120104,120105,120106,120110,120111,120112,120113,120114,120115,120116,120117,120118,120119,130200,130202,130203,130204,130205,130207,130208,130209,130224,130225,130227,130229,130281,130283,130284,130300,130302,130303,130304,130306,130321,130322,130324,130400,130402,130403,130404,130406,130407,130408,130423,130424,130425,130426,130427,130430,130431,130432,130433,130434,130435,130481,130500,130502,130503,130521,130522,130523,130524,130525,130526,130527,130528,130529,130530,130531,130532,130533,130534,130535,130581,130582,130600,130602,130606,130607,130608,130609,130623,130624,130626,130627,130628,130629,130630,130631,130632,130633,130634,130635,130636,130637,130638,130681,130682,130683,130684,130700,130702,130703,130705,130706,130708,130709,130722,130723,130724,130725,130726,130727,130728,130730,130731,130732,130800,130802,130803,130804,130821,130822,130824,130825,130826,130827,130828,130881,130900,130902,130903,130921,130922,130923,130924,130925,130926,130927,130928,130929,130930,130981,130982,130983,130984,131000,131002,131003,131022,131023,131024,131025,131026,131028,131081,131082,131100,131102,131103,131121,131122,131123,131124,131125,131126,131127,131128,131182'
instance.forEach(treeData,(node) => {
  node.childrenLength = node.child && node.child.length
})

const filteredTree = instance.filter(treeData, node => {
  const isExist = selectedData.split(',').includes(node.id)
  node.filteredLength = node.child && node.child.length
  return isExist
})

console.log(JSON.stringify(filteredTree))

const result = []
instance.iterator(filteredTree, node => {
  if (node.child && node.childrenLength === node.child.length) {
    result.push(node.name)
    return false
  } else if (!node.child) {
    result.push(node.name)
    return false
  } else {
    return true
  }
})

console.log(result)